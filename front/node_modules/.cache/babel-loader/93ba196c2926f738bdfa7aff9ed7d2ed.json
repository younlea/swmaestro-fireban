{"ast":null,"code":"import _slicedToArray from\"/home/webmaster/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/home/webmaster/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";function _templateObject(){var data=_taggedTemplateLiteral([\"\\n    border-radius: 4px;\\n    border: none;\\n    color: white;\\n    outline: none;\\n    cursor: pointer;\\n    background-color: #a1a6ad;\\n    font-weight: 700;\\n    font-size: 0.8rem;\\n    width: 110px;\\n    height: 40px;\\n    color: #ffffff;\\n\\n    & + & {\\n      margin-left: 1rem;\\n    }\\n\"]);_templateObject=function _templateObject(){return data;};return data;}import React,{useRef}from\"react\";import{Stage,Layer}from\"react-konva\";import{useDispatch}from\"react-redux\";import{addDetectInfo,changeDetectInfo,deleteDetectInfo,updateDetectInfo}from\"../../store/modules/detect\";import Rectangle from\"./Rectangle\";import{makeStyles}from'@material-ui/core/styles';import Table from'@material-ui/core/Table';import TableBody from'@material-ui/core/TableBody';import TableCell from'@material-ui/core/TableCell';import TableContainer from'@material-ui/core/TableContainer';import TableHead from'@material-ui/core/TableHead';import TableRow from'@material-ui/core/TableRow';import Paper from'@material-ui/core/Paper';import styled from\"styled-components\";// import Button from \"../CustomButtons/Button.js\";\nvar CustomButton=styled.button(_templateObject());var Canvas=function Canvas(_ref){var initialState=_ref.initialState,targetKey=_ref.targetKey;var dispatch=useDispatch();var newTarget=useRef(0);// const [rectangles, setRectangles] = React.useState(initialState);\nvar _React$useState=React.useState(null),_React$useState2=_slicedToArray(_React$useState,2),selectedId=_React$useState2[0],selectShape=_React$useState2[1];var checkDeselect=function checkDeselect(e){// deselect when clicked on empty area\nvar clickedOnEmpty=e.target===e.target.getStage();if(clickedOnEmpty){selectShape(null);}};// onChange={(newAttrs) => {\n//               const rects = initialState.slice();\n//               rects[i] = newAttrs;\n//               // setRectangles(rects);\n//             }}\nvar onChange=function onChange(newAttrs){dispatch(changeDetectInfo(newAttrs));};var onDelete=function onDelete(e){e.preventDefault();console.log(e.target);// console.log(e.target.dataset.index);\nconsole.log(e.target.dataset.index);dispatch(deleteDetectInfo(Number(e.target.dataset.index)));};var onAdd=function onAdd(e){e.preventDefault();dispatch(addDetectInfo(newTarget.current));newTarget.current+=1;};var onUpdate=function onUpdate(e){console.log(targetKey);dispatch(updateDetectInfo({target:initialState,targetKey:Number(targetKey)}));window.location.reload();};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Stage,{width:640,height:500,onMouseDown:checkDeselect,onTouchStart:checkDeselect},/*#__PURE__*/React.createElement(Layer,{style:{position:\"absolute\"}},initialState.map(function(rect,i){return/*#__PURE__*/React.createElement(Rectangle,{key:i,shapeProps:rect,isSelected:rect.id===selectedId,onSelect:function onSelect(){selectShape(rect.id);},onChange:onChange});}))),/*#__PURE__*/React.createElement(TableContainer,{component:Paper},/*#__PURE__*/React.createElement(Table,{className:makeStyles.table,\"aria-label\":\"simple table\"},/*#__PURE__*/React.createElement(TableHead,null,/*#__PURE__*/React.createElement(TableRow,null,/*#__PURE__*/React.createElement(TableCell,{align:\"center\"},\"\\uAD6C\\uBD84\"),/*#__PURE__*/React.createElement(TableCell,{align:\"center\"},\"X\\uC88C\\uB8CC\"),/*#__PURE__*/React.createElement(TableCell,{align:\"center\"},\"Y\\uC88C\\uD45C\"),/*#__PURE__*/React.createElement(TableCell,{align:\"center\"},\"\\uB113\\uC774\"),/*#__PURE__*/React.createElement(TableCell,{align:\"center\"},\"\\uB192\\uC774\"),/*#__PURE__*/React.createElement(TableCell,{align:\"center\"},\"\\uBD84\\uB958\"),/*#__PURE__*/React.createElement(TableCell,{align:\"center\"},\"\\uC81C\\uAC70\"))),/*#__PURE__*/React.createElement(TableBody,null,initialState.map(function(row,i){return/*#__PURE__*/React.createElement(TableRow,{key:row.id},/*#__PURE__*/React.createElement(TableCell,{align:\"center\"},i+1),/*#__PURE__*/React.createElement(TableCell,{align:\"center\"},row.x),/*#__PURE__*/React.createElement(TableCell,{align:\"center\"},row.y),/*#__PURE__*/React.createElement(TableCell,{align:\"center\"},row.width),/*#__PURE__*/React.createElement(TableCell,{align:\"center\"},row.height),/*#__PURE__*/React.createElement(TableCell,{align:\"center\"},row.type===0?\"사람\":\"화재\"),/*#__PURE__*/React.createElement(TableCell,{\"data-index\":row.id,align:\"center\"},/*#__PURE__*/React.createElement(CustomButton,{\"data-index\":row.id,onClick:onDelete},\"\\uC0AD\\uC81C\")));})))),/*#__PURE__*/React.createElement(\"div\",{style:{marginTop:\"0.5rem\",width:\"100%\",textAlign:\"right\"}},/*#__PURE__*/React.createElement(CustomButton,{onClick:onAdd},\"\\uCD94\\uAC00\"),/*#__PURE__*/React.createElement(CustomButton,{onClick:onUpdate},\"\\uC800\\uC7A5\")));};export default Canvas;","map":{"version":3,"sources":["/home/webmaster/front/src/components/Detect/Canvas.js"],"names":["React","useRef","Stage","Layer","useDispatch","addDetectInfo","changeDetectInfo","deleteDetectInfo","updateDetectInfo","Rectangle","makeStyles","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","Paper","styled","CustomButton","button","Canvas","initialState","targetKey","dispatch","newTarget","useState","selectedId","selectShape","checkDeselect","e","clickedOnEmpty","target","getStage","onChange","newAttrs","onDelete","preventDefault","console","log","dataset","index","Number","onAdd","current","onUpdate","window","location","reload","position","map","rect","i","id","table","row","x","y","width","height","type","marginTop","textAlign"],"mappings":"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","sourcesContent":["import React, { useRef } from \"react\";\nimport { Stage, Layer } from \"react-konva\";\nimport { useDispatch } from \"react-redux\";\nimport { addDetectInfo, changeDetectInfo, deleteDetectInfo, updateDetectInfo } from \"../../store/modules/detect\";\nimport Rectangle from \"./Rectangle\";\nimport { makeStyles } from '@material-ui/core/styles';\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableCell from '@material-ui/core/TableCell';\nimport TableContainer from '@material-ui/core/TableContainer';\nimport TableHead from '@material-ui/core/TableHead';\nimport TableRow from '@material-ui/core/TableRow';\nimport Paper from '@material-ui/core/Paper';\nimport styled from \"styled-components\";\n// import Button from \"../CustomButtons/Button.js\";\n\nconst CustomButton = styled.button`\n    border-radius: 4px;\n    border: none;\n    color: white;\n    outline: none;\n    cursor: pointer;\n    background-color: #a1a6ad;\n    font-weight: 700;\n    font-size: 0.8rem;\n    width: 110px;\n    height: 40px;\n    color: #ffffff;\n\n    & + & {\n      margin-left: 1rem;\n    }\n`;\n\nconst Canvas = ({ initialState, targetKey }) => {\n  \n  const dispatch=useDispatch()\n  \n  const newTarget = useRef(0);\n\n  // const [rectangles, setRectangles] = React.useState(initialState);\n  const [selectedId, selectShape] = React.useState(null);\n\n  const checkDeselect = (e) => {\n    // deselect when clicked on empty area\n    const clickedOnEmpty = e.target === e.target.getStage();\n    if (clickedOnEmpty) {\n      selectShape(null);\n    }\n  };\n\n\n  // onChange={(newAttrs) => {\n  //               const rects = initialState.slice();\n  //               rects[i] = newAttrs;\n  //               // setRectangles(rects);\n  //             }}\n\n  const onChange = (newAttrs) => {\n    dispatch(changeDetectInfo(newAttrs))\n  }\n  const onDelete = (e) => {\n    e.preventDefault();\n    console.log(e.target);\n    // console.log(e.target.dataset.index);\n    console.log(e.target.dataset.index);\n    dispatch(deleteDetectInfo(Number(e.target.dataset.index)))\n  }\n\n  const onAdd = (e) => {\n    e.preventDefault();\n    dispatch(addDetectInfo(newTarget.current));\n    newTarget.current+=1;\n  }\n\n  const onUpdate = (e) => {\n    console.log(targetKey)\n    dispatch(updateDetectInfo({target: initialState, targetKey:Number(targetKey)}))\n    window.location.reload();\n  }\n\n\n  return (\n    <>\n      <Stage width={640} height={500} onMouseDown={checkDeselect}\n      onTouchStart={checkDeselect}>\n        <Layer style={{ position: \"absolute\" }}>\n          {initialState.map((rect, i) => {\n          return (\n            <Rectangle\n              key={i}\n              shapeProps={rect}\n              isSelected={rect.id === selectedId}\n              onSelect={() => {\n                selectShape(rect.id);\n              }}\n              onChange={onChange}\n            />\n          );\n        })}\n        </Layer>\n      </Stage>\n\n      <TableContainer component={Paper}>\n      <Table className={makeStyles.table} aria-label=\"simple table\">\n        <TableHead>\n          <TableRow>\n            <TableCell align=\"center\">구분</TableCell>\n            <TableCell align=\"center\">X좌료</TableCell>\n            <TableCell align=\"center\">Y좌표</TableCell>\n            <TableCell align=\"center\">넓이</TableCell>\n            <TableCell align=\"center\">높이</TableCell>\n            <TableCell align=\"center\">분류</TableCell>\n            <TableCell align=\"center\">제거</TableCell>\n          </TableRow>\n        </TableHead>\n        <TableBody>\n          {initialState.map((row, i) => (\n            <TableRow key={row.id}>\n              <TableCell align=\"center\">\n                {i+1}\n              </TableCell>\n              <TableCell align=\"center\">{row.x}</TableCell>\n              <TableCell align=\"center\">{row.y}</TableCell>\n              <TableCell align=\"center\">{row.width}</TableCell>\n              <TableCell align=\"center\">{row.height}</TableCell>\n              <TableCell align=\"center\">{row.type === 0 ? \"사람\" : \"화재\"}</TableCell>\n              <TableCell data-index={row.id} align=\"center\"><CustomButton data-index={row.id} onClick={onDelete}>삭제</CustomButton></TableCell>\n            </TableRow>\n          ))}\n        </TableBody>\n      </Table>\n    </TableContainer>\n    <div style={{marginTop: \"0.5rem\", width: \"100%\", textAlign: \"right\"}}>\n    <CustomButton onClick={onAdd}>추가</CustomButton>\n    <CustomButton onClick={onUpdate}>저장</CustomButton>\n    </div>\n    </>\n  );\n};\n\nexport default Canvas;\n"]},"metadata":{},"sourceType":"module"}