{"ast":null,"code":"import _slicedToArray from\"/home/webmaster/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from\"react\";import{Stage,Layer}from\"react-konva\";import{useDispatch}from\"react-redux\";import{changeDetectInfo,deleteDetectInfo}from\"../../store/modules/detect\";import Rectangle from\"./Rectangle\";import{makeStyles}from'@material-ui/core/styles';import Table from'@material-ui/core/Table';import TableBody from'@material-ui/core/TableBody';import TableCell from'@material-ui/core/TableCell';import TableContainer from'@material-ui/core/TableContainer';import TableHead from'@material-ui/core/TableHead';import TableRow from'@material-ui/core/TableRow';import Paper from'@material-ui/core/Paper';import Button from\"../CustomButtons/Button.js\";var Canvas=function Canvas(_ref){var initialState=_ref.initialState;var dispatch=useDispatch();// const [rectangles, setRectangles] = React.useState(initialState);\nvar _React$useState=React.useState(null),_React$useState2=_slicedToArray(_React$useState,2),selectedId=_React$useState2[0],selectShape=_React$useState2[1];var checkDeselect=function checkDeselect(e){// deselect when clicked on empty area\nvar clickedOnEmpty=e.target===e.target.getStage();if(clickedOnEmpty){selectShape(null);}};// onChange={(newAttrs) => {\n//               const rects = initialState.slice();\n//               rects[i] = newAttrs;\n//               // setRectangles(rects);\n//             }}\nvar onChange=function onChange(newAttrs){dispatch(changeDetectInfo(newAttrs));};var onDelete=function onDelete(e){// console.log(e.target.dataset.index);\ndispatch(deleteDetectInfo(e.target.dataset.index));};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Stage,{width:\"320\",height:\"240\",onMouseDown:checkDeselect,onTouchStart:checkDeselect},/*#__PURE__*/React.createElement(Layer,{style:{position:\"absolute\"}},initialState.map(function(rect,i){return/*#__PURE__*/React.createElement(Rectangle,{key:i,shapeProps:rect,isSelected:rect.id===selectedId,onSelect:function onSelect(){selectShape(rect.id);}// onChange={(newAttrs) => {\n//   const rects = initialState.slice();\n//   rects[i] = newAttrs;\n//   // setRectangles(rects);\n// }}\n,onChange:onChange});}))),/*#__PURE__*/React.createElement(TableContainer,{component:Paper},/*#__PURE__*/React.createElement(Table,{className:makeStyles.table,\"aria-label\":\"simple table\"},/*#__PURE__*/React.createElement(TableHead,null,/*#__PURE__*/React.createElement(TableRow,null,/*#__PURE__*/React.createElement(TableCell,{align:\"center\"},\"\\uAD6C\\uBD84\"),/*#__PURE__*/React.createElement(TableCell,{align:\"center\"},\"X\\uC88C\\uB8CC\"),/*#__PURE__*/React.createElement(TableCell,{align:\"center\"},\"Y\\uC88C\\uD45C\"),/*#__PURE__*/React.createElement(TableCell,{align:\"center\"},\"\\uB113\\uC774\"),/*#__PURE__*/React.createElement(TableCell,{align:\"center\"},\"\\uB192\\uC774\"),/*#__PURE__*/React.createElement(TableCell,{align:\"center\"},\"\\uBD84\\uB958\"),/*#__PURE__*/React.createElement(TableCell,{align:\"center\"},\"\\uC81C\\uAC70\"))),/*#__PURE__*/React.createElement(TableBody,null,initialState.map(function(row,i){return/*#__PURE__*/React.createElement(TableRow,{key:row.id},/*#__PURE__*/React.createElement(TableCell,{align:\"center\"},i+1),/*#__PURE__*/React.createElement(TableCell,{align:\"center\"},row.x),/*#__PURE__*/React.createElement(TableCell,{align:\"center\"},row.y),/*#__PURE__*/React.createElement(TableCell,{align:\"center\"},row.width),/*#__PURE__*/React.createElement(TableCell,{align:\"center\"},row.height),/*#__PURE__*/React.createElement(TableCell,{align:\"center\"},row.type===0?\"사람\":\"화재\"),/*#__PURE__*/React.createElement(TableCell,{align:\"center\"},/*#__PURE__*/React.createElement(Button,{\"data-index\":row.id,onClick:onDelete},\"\\uC0AD\\uC81C\")));})))));};export default Canvas;","map":{"version":3,"sources":["/home/webmaster/front/src/components/Detect/Canvas.js"],"names":["React","Stage","Layer","useDispatch","changeDetectInfo","deleteDetectInfo","Rectangle","makeStyles","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","Paper","Button","Canvas","initialState","dispatch","useState","selectedId","selectShape","checkDeselect","e","clickedOnEmpty","target","getStage","onChange","newAttrs","onDelete","dataset","index","position","map","rect","i","id","table","row","x","y","width","height","type"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { Stage, Layer } from \"react-konva\";\nimport { useDispatch } from \"react-redux\";\nimport { changeDetectInfo, deleteDetectInfo } from \"../../store/modules/detect\";\nimport Rectangle from \"./Rectangle\";\nimport { makeStyles } from '@material-ui/core/styles';\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableCell from '@material-ui/core/TableCell';\nimport TableContainer from '@material-ui/core/TableContainer';\nimport TableHead from '@material-ui/core/TableHead';\nimport TableRow from '@material-ui/core/TableRow';\nimport Paper from '@material-ui/core/Paper';\nimport Button from \"../CustomButtons/Button.js\";\n\nconst Canvas = ({ initialState }) => {\n  const dispatch=useDispatch()\n  \n\n\n  // const [rectangles, setRectangles] = React.useState(initialState);\n  const [selectedId, selectShape] = React.useState(null);\n\n  const checkDeselect = (e) => {\n    // deselect when clicked on empty area\n    const clickedOnEmpty = e.target === e.target.getStage();\n    if (clickedOnEmpty) {\n      selectShape(null);\n    }\n  };\n\n\n  // onChange={(newAttrs) => {\n  //               const rects = initialState.slice();\n  //               rects[i] = newAttrs;\n  //               // setRectangles(rects);\n  //             }}\n\n  const onChange = (newAttrs) => {\n    dispatch(changeDetectInfo(newAttrs))\n  }\n  const onDelete = (e) => {\n    // console.log(e.target.dataset.index);\n    dispatch(deleteDetectInfo(e.target.dataset.index))\n  }\n\n\n  return (\n    <>\n      <Stage width=\"320\" height=\"240\" onMouseDown={checkDeselect}\n      onTouchStart={checkDeselect}>\n        <Layer style={{ position: \"absolute\" }}>\n          {initialState.map((rect, i) => {\n          return (\n            <Rectangle\n              key={i}\n              shapeProps={rect}\n              isSelected={rect.id === selectedId}\n              onSelect={() => {\n                selectShape(rect.id);\n              }}\n              // onChange={(newAttrs) => {\n              //   const rects = initialState.slice();\n              //   rects[i] = newAttrs;\n              //   // setRectangles(rects);\n              // }}\n              onChange={onChange}\n            />\n          );\n        })}\n        </Layer>\n      </Stage>\n\n      <TableContainer component={Paper}>\n      <Table className={makeStyles.table} aria-label=\"simple table\">\n        <TableHead>\n          <TableRow>\n            <TableCell align=\"center\">구분</TableCell>\n            <TableCell align=\"center\">X좌료</TableCell>\n            <TableCell align=\"center\">Y좌표</TableCell>\n            <TableCell align=\"center\">넓이</TableCell>\n            <TableCell align=\"center\">높이</TableCell>\n            <TableCell align=\"center\">분류</TableCell>\n            <TableCell align=\"center\">제거</TableCell>\n          </TableRow>\n        </TableHead>\n        <TableBody>\n          {initialState.map((row, i) => (\n            <TableRow key={row.id}>\n              <TableCell align=\"center\">\n                {i+1}\n              </TableCell>\n              <TableCell align=\"center\">{row.x}</TableCell>\n              <TableCell align=\"center\">{row.y}</TableCell>\n              <TableCell align=\"center\">{row.width}</TableCell>\n              <TableCell align=\"center\">{row.height}</TableCell>\n              <TableCell align=\"center\">{row.type === 0 ? \"사람\" : \"화재\"}</TableCell>\n              <TableCell align=\"center\"><Button data-index={row.id} onClick={onDelete}>삭제</Button></TableCell>\n            </TableRow>\n          ))}\n        </TableBody>\n      </Table>\n    </TableContainer>\n\n{/* \n        {initialState.map((rect, i) => {\n          return (<><div><span>{i+1} </span><span>{rect.id} </span><span>{rect.x} </span><span>{rect.y} </span> <span>{rect.width} </span> <span>{rect.height} </span><span>{rect.type} </span><button data-index={rect.id} onClick={onDelete}>삭제</button></div>\n          </>)\n        })} */}\n\n        \n    </>\n  );\n};\n\nexport default Canvas;\n"]},"metadata":{},"sourceType":"module"}