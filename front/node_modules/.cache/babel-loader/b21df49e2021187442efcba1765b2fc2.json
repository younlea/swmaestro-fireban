{"ast":null,"code":"import _defineProperty from\"/home/webmaster/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/home/webmaster/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/home/webmaster/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _slicedToArray from\"/home/webmaster/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";var _handleActions;var _marked=/*#__PURE__*/_regeneratorRuntime.mark(userSaga);import{createAction,handleActions}from\"redux-actions\";import{takeLatest}from\"redux-saga/effects\";import createRequestSaga,{createRequestActionTypes}from\"../../lib/createRequestSaga\";import{ACCESS_TOKEN,REFRESH_TOKEN}from\"../../lib/config\";import*as userAPI from\"../../lib/api/user\";//================================================\nvar _createRequestActionT=createRequestActionTypes(\"user/GET_USER_INFO\"),_createRequestActionT2=_slicedToArray(_createRequestActionT,3),GET_USER_INFO=_createRequestActionT2[0],GET_USER_INFO_SUCCESS=_createRequestActionT2[1],GET_USER_INFO_FAILURE=_createRequestActionT2[2];//================================================\n// action\nexport var getUser=createAction(GET_USER_INFO);//================================================»\n// saga 생성\nvar getUserInfoSaga=createRequestSaga(GET_USER_INFO,userAPI.userInfo);function getUserFailureSaga(){try{localStorage.removeItem(ACCESS_TOKEN);// localStorage 에서 user 제거하고\nlocalStorage.removeItem(REFRESH_TOKEN);}catch(e){console.log(e);}}export function userSaga(){return _regeneratorRuntime.wrap(function userSaga$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return takeLatest(GET_USER_INFO,getUserInfoSaga);case 2:_context.next=4;return takeLatest(GET_USER_INFO_FAILURE,getUserFailureSaga);case 4:case\"end\":return _context.stop();}}},_marked);}//================================================\n// 초기화\nexport var initialState={user:null,error:{type:null,description:null}};//================================================\nvar user=handleActions((_handleActions={},_defineProperty(_handleActions,GET_USER_INFO_SUCCESS,function(state,_ref){var data=_ref.payload;return _objectSpread({},state,{user:data.message,error:initialState.error});}),_defineProperty(_handleActions,GET_USER_INFO_FAILURE,function(state,_ref2){var error=_ref2.payload;return _objectSpread({},state,{user:null,error:{type:\"userInfo\",description:error}});}),_handleActions),initialState);export default user;","map":{"version":3,"sources":["/home/webmaster/front/src/store/modules/user.js"],"names":["userSaga","createAction","handleActions","takeLatest","createRequestSaga","createRequestActionTypes","ACCESS_TOKEN","REFRESH_TOKEN","userAPI","GET_USER_INFO","GET_USER_INFO_SUCCESS","GET_USER_INFO_FAILURE","getUser","getUserInfoSaga","userInfo","getUserFailureSaga","localStorage","removeItem","e","console","log","initialState","user","error","type","description","state","data","payload","message"],"mappings":"6mBAoCiBA,Q,EApCjB,OAASC,YAAT,CAAuBC,aAAvB,KAA4C,eAA5C,CACA,OAASC,UAAT,KAA2B,oBAA3B,CACA,MAAOC,CAAAA,iBAAP,EACEC,wBADF,KAEO,6BAFP,CAGA,OAASC,YAAT,CAAuBC,aAAvB,KAA4C,kBAA5C,CACA,MAAO,GAAKC,CAAAA,OAAZ,KAAyB,oBAAzB,CAEA;0BAMIH,wBAAwB,CAAC,oBAAD,C,gEAH1BI,a,2BACAC,qB,2BACAC,qB,2BAGF;AAEA;AAEA,MAAO,IAAMC,CAAAA,OAAO,CAAGX,YAAY,CAACQ,aAAD,CAA5B,CACP;AAEA;AAEA,GAAMI,CAAAA,eAAe,CAAGT,iBAAiB,CAACK,aAAD,CAAgBD,OAAO,CAACM,QAAxB,CAAzC,CAEA,QAASC,CAAAA,kBAAT,EAA8B,CAC5B,GAAI,CACFC,YAAY,CAACC,UAAb,CAAwBX,YAAxB,EAAuC;AACvCU,YAAY,CAACC,UAAb,CAAwBV,aAAxB,EACD,CAAC,MAAOW,CAAP,CAAU,CACVC,OAAO,CAACC,GAAR,CAAYF,CAAZ,EACD,CACF,CAED,MAAO,SAAUlB,CAAAA,QAAV,oIACL,MAAMG,CAAAA,UAAU,CAACM,aAAD,CAAgBI,eAAhB,CAAhB,CADK,uBAEL,MAAMV,CAAAA,UAAU,CAACQ,qBAAD,CAAwBI,kBAAxB,CAAhB,CAFK,sDAKP;AAEA;AACA,MAAO,IAAMM,CAAAA,YAAY,CAAG,CAC1BC,IAAI,CAAE,IADoB,CAE1BC,KAAK,CAAE,CACLC,IAAI,CAAE,IADD,CAELC,WAAW,CAAE,IAFR,CAFmB,CAArB,CAQP;AAEA,GAAMH,CAAAA,IAAI,CAAGpB,aAAa,mDAErBQ,qBAFqB,CAEG,SAACgB,KAAD,UAAmBC,CAAAA,IAAnB,MAAUC,OAAV,yBACpBF,KADoB,EAEvBJ,IAAI,CAAEK,IAAI,CAACE,OAFY,CAGvBN,KAAK,CAAEF,YAAY,CAACE,KAHG,IAFH,iCAOrBZ,qBAPqB,CAOG,SAACe,KAAD,WAAmBH,CAAAA,KAAnB,OAAUK,OAAV,yBACpBF,KADoB,EAEvBJ,IAAI,CAAE,IAFiB,CAGvBC,KAAK,CAAE,CAAEC,IAAI,CAAE,UAAR,CAAoBC,WAAW,CAAEF,KAAjC,CAHgB,IAPH,kBAaxBF,YAbwB,CAA1B,CAgBA,cAAeC,CAAAA,IAAf","sourcesContent":["import { createAction, handleActions } from \"redux-actions\";\nimport { takeLatest } from \"redux-saga/effects\";\nimport createRequestSaga, {\n  createRequestActionTypes\n} from \"../../lib/createRequestSaga\";\nimport { ACCESS_TOKEN, REFRESH_TOKEN } from \"../../lib/config\";\nimport * as userAPI from \"../../lib/api/user\";\n\n//================================================\n\nconst [\n  GET_USER_INFO,\n  GET_USER_INFO_SUCCESS,\n  GET_USER_INFO_FAILURE\n] = createRequestActionTypes(\"user/GET_USER_INFO\");\n\n//================================================\n\n// action\n\nexport const getUser = createAction(GET_USER_INFO);\n//================================================»\n\n// saga 생성\n\nconst getUserInfoSaga = createRequestSaga(GET_USER_INFO, userAPI.userInfo);\n\nfunction getUserFailureSaga() {\n  try {\n    localStorage.removeItem(ACCESS_TOKEN); // localStorage 에서 user 제거하고\n    localStorage.removeItem(REFRESH_TOKEN);\n  } catch (e) {\n    console.log(e);\n  }\n}\n\nexport function* userSaga() {\n  yield takeLatest(GET_USER_INFO, getUserInfoSaga);\n  yield takeLatest(GET_USER_INFO_FAILURE, getUserFailureSaga);\n}\n\n//================================================\n\n// 초기화\nexport const initialState = {\n  user: null,\n  error: {\n    type: null,\n    description: null\n  }\n};\n\n//================================================\n\nconst user = handleActions(\n  {\n    [GET_USER_INFO_SUCCESS]: (state, { payload: data }) => ({\n      ...state,\n      user: data.message,\n      error: initialState.error\n    }),\n    [GET_USER_INFO_FAILURE]: (state, { payload: error }) => ({\n      ...state,\n      user: null,\n      error: { type: \"userInfo\", description: error }\n    })\n  },\n  initialState\n);\n\nexport default user;\n"]},"metadata":{},"sourceType":"module"}